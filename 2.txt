this is version 2 from branch master but now include login system